<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>구글드라이브 외부로 열기</title>
  <style>
    :root{--bg:#000;--fg:#fff;--muted:#ccc;--btn:#fff;--btnfg:#000}
    html,body{height:100%;margin:0}
    body{background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;display:grid;place-items:center}
    .wrap{display:none;max-width:680px;padding:1.2rem;text-align:center}
    .wrap.show{display:block}
    h1{font-size:1.2rem;margin:0 0 .75rem}
    p{margin:.5rem 0;color:var(--muted);line-height:1.6}
    .btn{background:var(--btn);color:var(--btnfg);border:0;border-radius:12px;padding:.9rem 1.2rem;font-weight:700;text-decoration:none;cursor:pointer;margin-top:1rem}
    .kbd{display:inline-block;border:1px solid #888;border-bottom-width:2px;border-radius:6px;padding:.2rem .45rem;margin:0 .2rem;background:#111;color:#eee}
  </style>
</head>
<body>
  <div id="fallback" class="wrap">
    <h1>카카오톡 인앱 브라우저에서 열렸습니다</h1>
    <p>
      <strong>오른쪽 아래 <span class="kbd">⋯</span> 버튼 → 다른 브라우저에서 열기</strong><br>
      를 눌러주세요.
    </p>
    <button id="copyBtn" class="btn">링크 복사 → 다른 브라우저에서 붙여넣어 실행</button>
  </div>

  <script>
    // === 설정: 이동할 구글드라이브 주소 ===
    const DRIVE_URL = "https://drive.google.com/drive/folders/1Iax6j8wGi6z6mV21craLi7TY0u9sW_3K?usp=sharing";

    const ua = navigator.userAgent || navigator.vendor || window.opera || "";
    const lo = ua.toLowerCase();
    const isKakao = lo.includes("kakaotalk");
    const isAndroid = lo.includes("android");
    const isIOS = lo.includes("iphone") || lo.includes("ipad") || lo.includes("ipod");

    const $fallback = document.getElementById("fallback");
    const $copyBtn = document.getElementById("copyBtn");

    $copyBtn.addEventListener("click", async () => {
      try {
        await navigator.clipboard.writeText(DRIVE_URL);
        $copyBtn.textContent = "복사됨! 브라우저에 붙여넣어 실행하세요.";
      } catch (e) {
        alert("복사에 실패했습니다. 아래 주소를 수동으로 복사해주세요:\n" + DRIVE_URL);
      }
    });

    // 카톡 외부 → 그냥 이동
    if (!isKakao) {
      location.replace(DRIVE_URL);
    } else {
      // 카톡 인앱: 우선 외부로 띄우기 시도
      const tryAndroidIntentToChrome =
        "intent://drive.google.com/drive/folders/1Iax6j8wGi6z6mV21craLi7TY0u9sW_3K#Intent;scheme=https;package=com.android.chrome;end";
      const tryAndroidIntentToDriveApp =
        "intent://drive.google.com/drive/folders/1Iax6j8wGi6z6mV21craLi7TY0u9sW_3K#Intent;scheme=https;package=com.google.android.apps.docs;end";
      const tryIOSChromeScheme =
        "googlechromes://drive.google.com/drive/folders/1Iax6j8wGi6z6mV21craLi7TY0u9sW_3K";

      const showTip = () => { $fallback.classList.add("show"); };

      let switched = false;
      const onHide = () => { switched = true; };
      document.addEventListener("visibilitychange", onHide, { once: true });

      if (isAndroid) {
        location.href = tryAndroidIntentToChrome;
        setTimeout(() => { if (!switched) location.href = tryAndroidIntentToDriveApp; }, 800);
        setTimeout(() => { if (!switched) showTip(); }, 1400);
      } else if (isIOS) {
        location.href = tryIOSChromeScheme;
        setTimeout(() => { if (!switched) showTip(); }, 900);
      } else {
        location.href = DRIVE_URL;
        setTimeout(() => { if (!switched) showTip(); }, 900);
      }
    }
  </script>
</body>
</html>
